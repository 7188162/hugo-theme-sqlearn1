{{/*
  å­¦ç¿’é€²æ—ãƒãƒ£ãƒ¼ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã‚·ãƒ§ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰
  ä½¿ã„æ–¹: {{< progress-chart >}}
*/}}

<div class="progress-chart-container" id="progress-chart-{{ .Ordinal }}">
    <h3>ğŸ“Š å­¦ç¿’é€²æ—ãƒãƒ£ãƒ¼ãƒˆ</h3>
    <p class="chart-description">ã“ã®ç« ã§ã®å­¦ç¿’é …ç›®ã¨å®Œäº†çŠ¶æ³ã‚’å¯è¦–åŒ–ã§ãã¾ã™</p>
    
    <div class="chart-wrapper">
        <canvas id="progressChart-{{ .Ordinal }}" width="400" height="200"></canvas>
    </div>
    
    <div class="chart-legend">
        <div class="legend-item">
            <span class="legend-color completed"></span>
            <span>å®Œäº†</span>
        </div>
        <div class="legend-item">
            <span class="legend-color in-progress"></span>
            <span>å­¦ç¿’ä¸­</span>
        </div>
        <div class="legend-item">
            <span class="legend-color not-started"></span>
            <span>æœªé–‹å§‹</span>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const ctx = document.getElementById('progressChart-{{ .Ordinal }}');
    if (ctx) {
        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯å‹•çš„ã«ç”Ÿæˆï¼‰
        const progressData = {
            labels: [
                'SELECTæ–‡ã®åŸºæœ¬',
                'WHEREå¥ã®ä½¿ã„æ–¹', 
                'ORDER BYå¥',
                'GROUP BYé›†è¨ˆ',
                'çµåˆï¼ˆJOINï¼‰',
                'é–¢æ•°ã®æ´»ç”¨',
                'æ¼”ç¿’å•é¡Œ'
            ],
            datasets: [{
                label: 'é€²æ—çŠ¶æ³',
                data: [100, 100, 80, 60, 40, 20, 0], // ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸
                backgroundColor: [
                    '#10b981', // å®Œäº†ï¼ˆç·‘ï¼‰
                    '#10b981', 
                    '#f59e0b', // å­¦ç¿’ä¸­ï¼ˆé»„ï¼‰
                    '#f59e0b',
                    '#f59e0b',
                    '#ef4444', // æœªé–‹å§‹ï¼ˆèµ¤ï¼‰
                    '#ef4444'
                ],
                borderColor: [
                    '#059669',
                    '#059669',
                    '#d97706',
                    '#d97706', 
                    '#d97706',
                    '#dc2626',
                    '#dc2626'
                ],
                borderWidth: 2,
                borderRadius: 4,
                borderSkipped: false,
            }]
        };

        new Chart(ctx, {
            type: 'bar',
            data: progressData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.parsed.y + '% å®Œäº†';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        },
                        title: {
                            display: true,
                            text: 'å®Œäº†ç‡ (%)'
                        }
                    },
                    x: {
                        ticks: {
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                },
                elements: {
                    bar: {
                        borderRadius: 4
                    }
                }
            }
        });
    }
});
</script>

<style>
.progress-chart-container {
    background: linear-gradient(135f, #f8fafc 0%, #e2e8f0 100%);
    border: 1px solid var(--neutral-200);
    border-radius: 12px;
    padding: 1.5rem;
    margin: 2rem 0;
    border-left: 4px solid var(--primary-blue);
}

.progress-chart-container h3 {
    color: var(--primary-blue);
    margin-bottom: 0.5rem;
    font-weight: 600;
}

.chart-description {
    color: var(--neutral-600);
    font-size: 0.9rem;
    margin-bottom: 1.5rem;
}

.chart-wrapper {
    position: relative;
    height: 300px;
    margin-bottom: 1rem;
}

.chart-legend {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    flex-wrap: wrap;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
}

.legend-color {
    width: 16px;
    height: 16px;
    border-radius: 3px;
    display: inline-block;
}

.legend-color.completed {
    background: #10b981;
}

.legend-color.in-progress {
    background: #f59e0b;
}

.legend-color.not-started {
    background: #ef4444;
}

@media (max-width: 768px) {
    .chart-wrapper {
        height: 250px;
    }
    
    .chart-legend {
        justify-content: center;
        gap: 1rem;
    }
}
</style>